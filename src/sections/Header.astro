---
import Logo from '@/icons/Logo.svg'
import V0Logo from '@/icons/V0Logo.svg?raw'
---

<header
  class="fixed top-0 w-full bg-dark-bg/90 backdrop-blur-md z-50 border-b border-white/10 transition-all duration-300"
>
  <div class="container mx-auto px-5">
    <nav class="flex justify-between items-center h-16 md:h-20">
      <a
        href="/"
        class="flex items-center gap-3 group transition-all duration-300"
        aria-label="Ir al inicio"
      >
        <Logo class="h-8 sm:h-10 md:h-12 w-auto transition-transform group-hover:scale-105" />
        <div class="flex flex-col justify-center">
          <div class="flex items-center gap-1.5 md:gap-2">
            <span
              class="text-lg sm:text-xl md:text-2xl font-bold font-clash text-white tracking-tighter leading-none uppercase"
            >
              JSConf <span class="text-js-yellow font-bold">España</span>
            </span>
            <span
              class="hidden sm:block min-[1028px]:hidden 2xl:block bg-js-yellow text-js-black text-[8px] md:text-xs px-1 md:px-1.5 py-0.5 rounded-sm font-black leading-none transform -rotate-2 shadow-[2px_2px_0px_rgba(255,255,255,0.2)]"
            >
              2026
            </span>
          </div>
          <p
            class="hidden sm:block min-[1028px]:hidden 2xl:block text-[8px] md:text-[10px] font-bold text-white/40 uppercase tracking-[0.1em] md:tracking-[0.2em] mt-1 leading-none transition-colors group-hover:text-js-yellow/60"
          >
            14 Mar · La Nave, Madrid
          </p>
        </div>
      </a>
      <div class="hidden min-[1028px]:flex gap-4 2xl:gap-8">
        <a
          href="#speakers"
          class="hidden 2xl:block text-sm font-medium text-gray-400 hover:text-js-yellow transition-colors"
          >Speakers</a
        >
        <a
          href="#agenda"
          class="text-sm font-medium text-gray-400 hover:text-js-yellow transition-colors flex items-center gap-1.5"
          >Agenda <span class="size-1.5 rounded-full bg-js-yellow animate-soft-pulse shadow-[0_0_8px_rgba(247,223,30,0.6)]"></span></a
        >
        <a
          href="#workshops"
          class="hidden 2xl:block text-sm font-medium text-gray-400 hover:text-js-yellow transition-colors"
          >Workshops</a
        >
        <a
          href="#sponsors"
          class="text-sm font-medium text-gray-400 hover:text-js-yellow transition-colors"
          >Patrocinadores</a
        >
        <a
          href="#activities"
          class="hidden 2xl:block text-sm font-medium text-gray-400 hover:text-js-yellow transition-colors"
          >Actividades</a
        >
        <a
          href="#hackathon"
          class="text-sm font-medium bg-gradient-to-r from-white via-white to-gray-400 bg-clip-text text-transparent hover:to-js-yellow transition-all flex items-center gap-1 group/hackathon"
        >
          Hackathon
          <span class="size-4 text-white group-hover/hackathon:scale-110 group-hover/hackathon:text-js-yellow transition-all">
            <Fragment set:html={V0Logo} />
          </span>
        </a>
        <a
          href="#venue"
          class="hidden 2xl:block text-sm font-medium text-gray-400 hover:text-js-yellow transition-colors">Mapa</a
        >
      </div>
      <div class="flex gap-4 items-center">
        <button
          id="buy-tickets-header"
          class="hidden sm:inline-flex min-[1028px]:hidden 2xl:inline-flex items-center justify-center px-5 py-2.5 font-bold uppercase tracking-wide text-sm bg-js-yellow text-js-black border-2 border-js-yellow rounded hover:bg-transparent hover:text-js-yellow hover:shadow-[0_0_15px_rgba(247,223,30,0.4)] transition-all"
          >ENTRADAS</button
        >
        <button
          id="menu-toggle"
          class="2xl:hidden text-white text-2xl focus:outline-none cursor-pointer p-2 hover:text-js-yellow transition-colors"
          aria-label="Abrir menú"
        >
          <i class="fas fa-bars"></i>
        </button>
      </div>
    </nav>
  </div>
</header>

<!-- Mobile Menu -->
<div
  id="mobile-menu"
  class="fixed inset-0 w-screen h-dvh z-[100] bg-dark-bg/95 backdrop-blur-xl flex flex-col items-center justify-center gap-8 translate-x-full transition-transform duration-300 2xl:hidden"
>
  <button
    id="menu-close"
    class="absolute top-6 right-6 text-white text-3xl p-4 focus:outline-none hover:text-js-yellow transition-colors"
    aria-label="Cerrar menú"
  >
    <i class="fas fa-times"></i>
  </button>

  <nav class="flex flex-col items-center gap-8">
    <a
      href="#speakers"
      class="text-4xl font-black font-clash text-white hover:text-js-yellow transition-colors mobile-link uppercase tracking-tighter"
      >Speakers</a
    >
    <a
      href="#agenda"
      class="text-4xl font-black font-clash text-white hover:text-js-yellow transition-colors mobile-link uppercase tracking-tighter flex items-center gap-2.5"
      >Agenda <span class="size-3 rounded-full bg-js-yellow animate-soft-pulse shadow-[0_0_15px_rgba(247,223,30,0.8)]"></span></a
    >
    <a
      href="#workshops"
      class="text-4xl font-black font-clash text-white hover:text-js-yellow transition-colors mobile-link uppercase tracking-tighter"
      >Workshops</a
    >
    <a
      href="#sponsors"
      class="text-4xl font-black font-clash text-white hover:text-js-yellow transition-colors mobile-link uppercase tracking-tighter"
      >Patrocinadores</a
    >
    <a
      href="#activities"
      class="text-4xl font-black font-clash text-white hover:text-js-yellow transition-colors mobile-link uppercase tracking-tighter"
      >Actividades</a
    >
    <a
      href="#hackathon"
      class="text-4xl font-medium font-clash bg-gradient-to-r from-white to-gray-500 bg-clip-text text-transparent hover:to-js-yellow transition-all mobile-link uppercase tracking-tighter flex items-center gap-2 group/hackathon"
    >
      Hackathon
      <span class="size-8 text-white group-hover/hackathon:text-js-yellow transition-colors">
        <Fragment set:html={V0Logo} />
      </span>
    </a>
    <a
      href="#venue"
      class="text-4xl font-black font-clash text-white hover:text-js-yellow transition-colors mobile-link uppercase tracking-tighter"
      >Mapa</a
    >
  </nav>

  <button
    id="buy-tickets-mobile"
    class="mt-12 inline-flex items-center justify-center px-12 py-5 font-black uppercase tracking-widest text-xl bg-js-yellow text-js-black border-2 border-js-yellow rounded-full hover:bg-white hover:text-js-black hover:border-white hover:shadow-[0_0_30px_rgba(255,255,255,0.3)] transition-all active:scale-95 shadow-lg"
  >
    ENTRADAS
  </button>
</div>

<style>
  @keyframes soft-pulse {
    0%, 100% {
      transform: scale(1);
      opacity: 1;
    }
    50% {
      transform: scale(1.15);
      opacity: 0.75;
    }
  }

  .animate-soft-pulse {
    animation: soft-pulse 2.5s cubic-bezier(0.4, 0, 0.6, 1) infinite;
  }
</style>

<script>
  const menuToggle = document.getElementById('menu-toggle')
  const menuClose = document.getElementById('menu-close')
  const mobileMenu = document.getElementById('mobile-menu')
  const mobileLinks = document.querySelectorAll('.mobile-link')
  const buyTicketsHeader = document.getElementById('buy-tickets-header')
  const buyTicketsMobile = document.getElementById('buy-tickets-mobile')

  function openMenu() {
    mobileMenu?.classList.remove('translate-x-full')
    document.body.style.overflow = 'hidden'
  }

  function closeMenu() {
    mobileMenu?.classList.add('translate-x-full')
    document.body.style.overflow = ''
  }

  menuToggle?.addEventListener('click', openMenu)
  menuClose?.addEventListener('click', closeMenu)
  mobileLinks.forEach((link) => link.addEventListener('click', closeMenu))

  const handleBuyTickets = () => {
    window.dispatchEvent(new CustomEvent('open-ticket-tailor'))
    closeMenu()
  }

  buyTicketsHeader?.addEventListener('click', handleBuyTickets)
  buyTicketsMobile?.addEventListener('click', handleBuyTickets)

  // Scroll visibility
  let lastScroll = 0
  const header = document.querySelector('header')

  window.addEventListener('scroll', () => {
    const currentScroll = window.scrollY
    if (currentScroll <= 0) {
      header?.classList.remove('-translate-y-full')
      return
    }

    if (currentScroll > lastScroll && !mobileMenu?.classList.contains('translate-x-full')) {
      // scrolling down
    } else if (currentScroll > lastScroll && currentScroll > 80) {
      header?.classList.add('-translate-y-full')
    } else {
      // scrolling up
      header?.classList.remove('-translate-y-full')
    }
    lastScroll = currentScroll
  })
</script>
