---
import sponsors from '@/data/sponsors.json'
import infojobsLogo from '@/icons/InfojobsLogo.svg?raw'

const TIER_STYLES: Record<
  string,
  { container: string; badge: string; description: string; icon: string }
> = {
  platinum: {
    container: 'md:col-span-5 bg-gradient-to-br from-[#09f]/10 via-dark-surface to-dark-surface',
    badge: 'text-[#09f]',
    description: 'text-[11px] md:text-[12px] text-[#b5d9ff]',
    icon: 'fa-gem',
  },
  max: {
    container: 'md:col-span-4 bg-dark-surface',
    badge: 'text-[#ff3e00]',
    description: 'text-[10px] md:text-[11px] text-gray-500',
    icon: 'fa-trophy',
  },
  star: {
    container: 'md:col-span-3 bg-dark-surface',
    badge: 'text-gray-400',
    description: 'text-[10px] md:text-[11px] text-gray-500',
    icon: 'fa-star',
  },
}

const COMPANY_OVERRIDES: Record<string, { container?: string; image?: string }> = {
  Codely: {
    container: 'md:col-span-4 bg-dark-surface',
    image: 'max-w-[280px] md:max-w-[380px] max-h-[150px]',
  },
  CubePath: {
    image: 'max-w-[220px] md:max-w-[300px] max-h-[130px]',
  },
  DevTalles: {
    image: 'brightness-0 invert',
  },
}

function getContainerClasses(companyName: string, tierIcon: string) {
  const tierStyle = TIER_STYLES[tierIcon] || TIER_STYLES.star
  const override = COMPANY_OVERRIDES[companyName]
  return override?.container || tierStyle.container
}

function getImageClasses(companyName: string, tierIcon: string) {
  const override = COMPANY_OVERRIDES[companyName]
  if (override?.image && override.image.includes('max-w')) {
    return override.image
  }

  const baseClasses = override?.image || ''
  const sizeClasses =
    tierIcon === 'star' || tierIcon === 'max'
      ? 'max-w-[200px] md:max-w-[260px] max-h-[110px]'
      : 'max-w-[180px] md:max-w-[220px] max-h-[100px]'

  return `${baseClasses} ${sizeClasses}`.trim()
}
---

<section id="sponsors" class="py-20 bg-black relative overflow-hidden">
  <div class="container mx-auto px-5 text-center relative z-10">
    <h2 class="text-4xl md:text-5xl font-bold font-display mb-16 text-white">
      Nuestros Patrocinadores
    </h2>

    <div class="grid grid-cols-1 md:grid-cols-10 gap-4 md:gap-6 mb-12">
      <!-- Principal Sponsor -->
      <a
        href="https://www.infojobs.net"
        target="_blank"
        rel="noopener noreferrer"
        class="md:col-span-10 relative bg-gradient-to-br from-js-yellow/10 via-dark-surface to-dark-surface rounded-xl flex flex-col items-center justify-center p-8 md:p-12 border-2 border-js-yellow/50 hover:border-js-yellow transition-all duration-300 group overflow-hidden"
      >
        <span
          class="absolute top-4 left-4 text-xs font-bold uppercase tracking-wider text-js-yellow bg-js-yeellow/10 px-3 py-1 rounded bg-white/5"
        >
          <i class="fas fa-crown text-js-yellow mr-1"></i> Principal Sponsor
        </span>

        <div class="w-full max-w-[400px] mb-4">
          <Fragment set:html={infojobsLogo} />
        </div>
        <p class="text-xs md:text-sm uppercase font-light text-js-yellow/90 tracking-wider">
          Líder en oportunidades laborales para profesionales tecnológicos
        </p>
      </a>

      <!-- Other Sponsors -->
      {
        sponsors.map((tier) =>
          tier.companies.map((company) => (
            <a
              href={company.url}
              target="_blank"
              rel="noopener noreferrer"
              class:list={[
                'relative rounded-xl flex flex-col items-center justify-center p-6 md:p-8 transition-all duration-300 hover:scale-[1.02] hover:bg-[#252525] group border border-white/5',
                getContainerClasses(company.name, tier.icon),
              ]}
            >
              <span
                class:list={[
                  'absolute top-4 left-4 text-[10px] font-bold uppercase tracking-wider px-2 py-0.5 rounded bg-white/5',
                  TIER_STYLES[tier.icon]?.badge || TIER_STYLES.star.badge,
                ]}
              >
                <i class={`fas ${TIER_STYLES[tier.icon]?.icon || TIER_STYLES.star.icon} mr-1`} />{' '}
                {tier.category.replace('Sponsors ', '')}
              </span>

              <div class="flex-1 flex items-center justify-center w-full py-4">
                {company.image ? (
                  <img
                    src={company.image}
                    alt={company.name}
                    class:list={[
                      'object-contain transition-all duration-300 group-hover:scale-110',
                      getImageClasses(company.name, tier.icon),
                    ]}
                  />
                ) : (
                  <span class="text-white font-bold font-display text-2xl">{company.name}</span>
                )}
              </div>
              {company.description && (
                <p
                  class:list={[
                    'uppercase max-w-[240px] leading-tight font-light tracking-wider text-center',
                    TIER_STYLES[tier.icon]?.description || TIER_STYLES.star.description,
                  ]}
                >
                  {company.description}
                </p>
              )}
            </a>
          ))
        )
      }

      <!-- Become a Sponsor CTA -->
      <a
        href="mailto:miduga@gmail.com"
        target="_blank"
        rel="noopener noreferrer"
        class="md:col-span-3 relative bg-dark-surface/50 border-2 border-dashed border-white/10 rounded-xl flex flex-col items-start justify-center p-4 md:p-6 transition-all duration-300 hover:bg-dark-surface hover:border-white/20 group gap-3 text-left"
      >
        <div class="flex flex-col gap-1 max-w-md">
          <span class="text-base md:text-lg font-bold font-display text-white leading-tight">
            Tu empresa puede ser la siguiente
          </span>
          <p class="text-xs md:text-sm text-gray-400 text-balance">
            Apoya la comunidad del ecosistema de JavaScript en España
          </p>
        </div>

        <span
          class="inline-flex items-center justify-center px-4 py-2.5 font-semibold uppercase tracking-wide text-[10px] md:text-[11px] bg-white text-js-black rounded group-hover:bg-js-yellow transition-all whitespace-nowrap"
        >
          Ponerse en contacto
        </span>
      </a>
    </div>
  </div>
</section>
